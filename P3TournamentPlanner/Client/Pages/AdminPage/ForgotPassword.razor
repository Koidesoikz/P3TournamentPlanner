@using P3TournamentPlanner.Shared
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using P3TournamentPlanner.Client.Services;
@attribute [Authorize]
@inject HttpClient Http
@inject IHttpClientFactory ClientFactory
@inject NavigationManager NavigationManager
@inject MessageService MessageService
@page "/dinmor"

<div class="placement">
    <div class="box">
        <div class="top">
            <h2>Reset Password</h2>
            <hr  style=" color:white;"/>
        </div>
        <div class="mid">
            <Form>
                <div class="boxes">
                    <label>Email</label>
                    <input @bind="email" class="inputs" type="text" name="email" placeholder="Your email.."/>
                </div>
                <div class="boxes">
                    <label>Old Password</label>
                    <input @bind="oldPass" class="inputs" type="password" name="oldPassword" placeholder="Your old password.." />
                </div>
                <div class="boxes">
                    <label> New Password</label>
                    <input @bind="newPass" class="inputs" type="password" name="newPassword" placeholder=" Your new password.."/>
                </div>
                <div class="boxes">
                    <label> Confirm Password</label>
                    <input @bind="confPass" class="inputs" type="password" name="confirmPassword" placeholder="Your new password again.." />
                </div>
            </Form>
        </div>
        <div class="bot">
            <button id="knap" @onclick="ChangePassword">Ændre kode</button>
        </div>
    </div>
</div>

@code {
    List<string> data;

    string email = "";
    string newPass = "";
    string oldPass = "";
    string confPass = "";


    private async Task ChangePassword() {

        if(newPass == confPass) {
            data = new List<string>();

            data.Add(newPass);
            data.Add(oldPass);
            data.Add(email);

            var res = await Http.PostAsJsonAsync<List<string>>("api/User/changePassword", data);

            Console.WriteLine(res);
        } else {
            Console.WriteLine("NewPass and ConfPass not the same!");
        }
    }

}

